<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/FIXO/">
    <title>FIXO - Registrace dodavatele oprav</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="public/icons/icon-72x72.png">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="assets/css/main.css">
    <style>
        .provider-form {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: var(--space-4);
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: var(--space-2);
            color: var(--color-text-primary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-fast);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-3);
            margin: var(--space-4) 0;
        }

        .pricing-card {
            background: var(--color-bg-primary);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            text-align: center;
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .pricing-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .pricing-card.selected {
            border-color: var(--color-primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .pricing-card .plan-name {
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: var(--space-2);
        }

        .pricing-card .plan-price {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--space-1);
        }

        .pricing-card .plan-period {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-3);
        }

        .pricing-card .plan-features {
            text-align: left;
            list-style: none;
            padding: 0;
        }

        .pricing-card .plan-features li {
            padding: var(--space-1) 0;
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .pricing-card .plan-features li i {
            color: var(--color-success);
            margin-right: var(--space-2);
        }

        .geolocation-status {
            background: var(--color-bg-secondary);
            border-left: 3px solid var(--color-primary);
            padding: var(--space-3);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-3);
        }

        .geolocation-status.success {
            border-left-color: var(--color-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .geolocation-status.error {
            border-left-color: var(--color-danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            padding: var(--space-3) var(--space-6);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:disabled {
            background: var(--color-text-light);
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--color-bg-secondary);
            color: var(--color-text-primary);
            padding: var(--space-2) var(--space-4);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .btn-secondary:hover {
            background: var(--color-bg-primary);
            border-color: var(--color-primary);
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <i class="fas fa-tools"></i>
                    <span>FIXO</span>
                </a>

                <nav>
                    <a href="index.html">
                        <i class="fas fa-home"></i>
                        <span>Dom≈Ø</span>
                    </a>
                    <a href="repair.html">
                        <i class="fas fa-wrench"></i>
                        <span>Datab√°ze oprav</span>
                    </a>
                    <a href="partners.html">
                        <i class="fas fa-handshake"></i>
                        <span>Partne≈ôi</span>
                    </a>
                    <a href="providers.html" class="active">
                        <i class="fas fa-user-tie"></i>
                        <span>Pro dodavatele</span>
                    </a>
                    <a href="about.html">
                        <i class="fas fa-info-circle"></i>
                        <span>O n√°s</span>
                    </a>
                    <a href="contacts.html">
                        <i class="fas fa-envelope"></i>
                        <span>Kontakt</span>
                    </a>
                </nav>

                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>

            <div class="mobile-nav" id="mobileNav">
                <a href="index.html">
                    <i class="fas fa-home"></i>
                    <span>Dom≈Ø</span>
                </a>
                <a href="repair.html">
                    <i class="fas fa-wrench"></i>
                    <span>Datab√°ze oprav</span>
                </a>
                <a href="partners.html">
                    <i class="fas fa-handshake"></i>
                    <span>Partne≈ôi</span>
                </a>
                <a href="providers.html" class="active">
                    <i class="fas fa-user-tie"></i>
                    <span>Pro dodavatele</span>
                </a>
                <a href="about.html">
                    <i class="fas fa-info-circle"></i>
                    <span>O n√°s</span>
                </a>
                <a href="contacts.html">
                    <i class="fas fa-envelope"></i>
                    <span>Kontakt</span>
                </a>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main>
        <div class="container" style="padding: var(--space-4);">

            <!-- Header -->
            <div style="background: var(--color-bg-primary); border-radius: var(--radius-2xl); padding: var(--space-4); box-shadow: var(--shadow-xl); margin-bottom: var(--space-4);">
                <h1 style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-primary); margin-bottom: var(--space-2);">
                    <i class="fas fa-user-tie"></i> Registrace dodavatele oprav
                </h1>
                <p style="color: var(--color-text-secondary); font-size: var(--font-size-base);">
                    Sta≈àte se souƒç√°st√≠ s√≠tƒõ ovƒõ≈ôen√Ωch ≈ôemesln√≠k≈Ø a z√≠skejte p≈ô√≠stup k z√°kazn√≠k≈Øm ve va≈°em okol√≠.
                </p>
            </div>

            <!-- Registration Form -->
            <div class="provider-form">
                <form id="providerRegistrationForm">

                    <!-- Geolocation Section -->
                    <div class="form-group">
                        <label>
                            <i class="fas fa-map-marker-alt"></i> Va≈°e poloha
                        </label>
                        <div id="geolocationStatus" class="geolocation-status">
                            <i class="fas fa-spinner fa-spin"></i> Naƒç√≠t√°n√≠ polohy...
                        </div>
                        <button type="button" class="btn-secondary" onclick="getLocation()">
                            <i class="fas fa-crosshairs"></i> Z√≠skat aktu√°ln√≠ polohu
                        </button>
                        <input type="hidden" id="latitude" name="latitude">
                        <input type="hidden" id="longitude" name="longitude">
                    </div>

                    <!-- Company Info -->
                    <div class="form-group">
                        <label for="companyName">
                            <i class="fas fa-building"></i> N√°zev firmy *
                        </label>
                        <input type="text" id="companyName" name="companyName" required placeholder="Nap≈ô. Instalat√©r Nov√°k s.r.o.">
                    </div>

                    <div class="form-group">
                        <label for="ico">
                            <i class="fas fa-id-card"></i> IƒåO *
                        </label>
                        <input type="text" id="ico" name="ico" required placeholder="12345678" pattern="[0-9]{8}">
                    </div>

                    <!-- Contact Info -->
                    <div class="form-group">
                        <label for="contactName">
                            <i class="fas fa-user"></i> Kontaktn√≠ osoba *
                        </label>
                        <input type="text" id="contactName" name="contactName" required placeholder="Jm√©no a p≈ô√≠jmen√≠">
                    </div>

                    <div class="form-group">
                        <label for="email">
                            <i class="fas fa-envelope"></i> E-mail *
                        </label>
                        <input type="email" id="email" name="email" required placeholder="info@vase-firma.cz">
                    </div>

                    <div class="form-group">
                        <label for="phone">
                            <i class="fas fa-phone"></i> Telefon *
                        </label>
                        <input type="tel" id="phone" name="phone" required placeholder="+420 123 456 789">
                    </div>

                    <!-- Service Area -->
                    <div class="form-group">
                        <label for="serviceRadius">
                            <i class="fas fa-circle-notch"></i> R√°dius p≈Øsobnosti (km) *
                        </label>
                        <select id="serviceRadius" name="serviceRadius" required>
                            <option value="5">Do 5 km</option>
                            <option value="10" selected>Do 10 km</option>
                            <option value="20">Do 20 km</option>
                            <option value="50">Do 50 km</option>
                            <option value="100">Cel√° ƒåR</option>
                        </select>
                    </div>

                    <!-- Specialization -->
                    <div class="form-group">
                        <label for="specialization">
                            <i class="fas fa-wrench"></i> Specializace *
                        </label>
                        <select id="specialization" name="specialization" required multiple size="6">
                            <option value="bathroom">üöø Koupelna (voda, odpady)</option>
                            <option value="electrical">‚ö° Elekt≈ôina</option>
                            <option value="heating">üå°Ô∏è Topen√≠</option>
                            <option value="house">üè† D≈Øm (dve≈ôe, okna)</option>
                            <option value="kitchen">üç≥ Kuchy≈à</option>
                            <option value="garden">üå± Zahrada</option>
                        </select>
                        <small style="color: var(--color-text-secondary);">Podr≈æte Ctrl/Cmd pro v√Ωbƒõr v√≠ce specializac√≠</small>
                    </div>

                    <!-- Description -->
                    <div class="form-group">
                        <label for="description">
                            <i class="fas fa-align-left"></i> Popis slu≈æeb
                        </label>
                        <textarea id="description" name="description" placeholder="Popi≈°te sv√© slu≈æby, zku≈°enosti a reference..."></textarea>
                    </div>

                    <!-- Pricing Plans -->
                    <div class="form-group">
                        <label>
                            <i class="fas fa-crown"></i> Vyberte bal√≠ƒçek
                        </label>
                        <div class="pricing-plans" id="pricingPlans">
                            <div class="pricing-card" data-plan="basic" onclick="selectPlan('basic')">
                                <div class="plan-name">Z√°kladn√≠</div>
                                <div class="plan-price">0 Kƒç</div>
                                <div class="plan-period">ZDARMA</div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> Profil v datab√°zi</li>
                                    <li><i class="fas fa-check"></i> 5 popt√°vek/mƒõs√≠c</li>
                                    <li><i class="fas fa-check"></i> Z√°kladn√≠ statistiky</li>
                                </ul>
                            </div>

                            <div class="pricing-card" data-plan="premium" onclick="selectPlan('premium')">
                                <div class="plan-name">Premium</div>
                                <div class="plan-price">299 Kƒç</div>
                                <div class="plan-period">/ mƒõs√≠c</div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> V≈°e ze Z√°kladn√≠ho</li>
                                    <li><i class="fas fa-check"></i> Neomezen√© popt√°vky</li>
                                    <li><i class="fas fa-check"></i> Prioritn√≠ zobrazen√≠</li>
                                    <li><i class="fas fa-check"></i> Detailn√≠ statistiky</li>
                                    <li><i class="fas fa-check"></i> Odznak "Ovƒõ≈ôeno"</li>
                                </ul>
                            </div>

                            <div class="pricing-card" data-plan="enterprise" onclick="selectPlan('enterprise')">
                                <div class="plan-name">Enterprise</div>
                                <div class="plan-price">999 Kƒç</div>
                                <div class="plan-period">/ mƒõs√≠c</div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> V≈°e z Premium</li>
                                    <li><i class="fas fa-check"></i> Vlastn√≠ profil</li>
                                    <li><i class="fas fa-check"></i> Marketingov√° podpora</li>
                                    <li><i class="fas fa-check"></i> API integrace</li>
                                    <li><i class="fas fa-check"></i> Dedikovan√Ω √∫ƒçet</li>
                                </ul>
                            </div>
                        </div>
                        <input type="hidden" id="selectedPlan" name="selectedPlan" value="basic">
                    </div>

                    <!-- Submit Button -->
                    <div class="form-group">
                        <button type="submit" class="btn-primary" id="submitBtn">
                            <i class="fas fa-check-circle"></i> Registrovat se
                        </button>
                    </div>

                </form>
            </div>

        </div>
    </main>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>FIXO</h3>
                    <p>AI asistent pro okam≈æit√© opravy dom√°c√≠ch z√°vad. U≈°et≈ôete ƒças i pen√≠ze s profesion√°ln√≠mi n√°vody.</p>
                </div>
                <div class="footer-section">
                    <h3>Pr√°vn√≠ informace</h3>
                    <ul class="footer-links">
                        <li><a href="contacts.html#gdpr"><i class="fas fa-shield-alt"></i> Ochrana osobn√≠ch √∫daj≈Ø</a></li>
                        <li><a href="contacts.html#terms"><i class="fas fa-file-contract"></i> Obchodn√≠ podm√≠nky</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FIXO. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/js/api.js"></script>
    <script>
        let userLocation = null;

        // Mobile menu toggle
        document.getElementById('mobileMenuToggle').addEventListener('click', function() {
            this.classList.toggle('active');
            document.getElementById('mobileNav').classList.toggle('active');
        });

        // Get user location
        function getLocation() {
            const statusEl = document.getElementById('geolocationStatus');

            if (!navigator.geolocation) {
                statusEl.className = 'geolocation-status error';
                statusEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> Geolokace nen√≠ podporov√°na va≈°√≠m prohl√≠≈æeƒçem';
                return;
            }

            statusEl.className = 'geolocation-status';
            statusEl.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Naƒç√≠t√°n√≠ polohy...';

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    userLocation = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude,
                        accuracy: position.coords.accuracy
                    };

                    document.getElementById('latitude').value = userLocation.latitude;
                    document.getElementById('longitude').value = userLocation.longitude;

                    statusEl.className = 'geolocation-status success';
                    statusEl.innerHTML = `
                        <i class="fas fa-check-circle"></i>
                        Poloha z√≠sk√°na: ${userLocation.latitude.toFixed(4)}, ${userLocation.longitude.toFixed(4)}
                        (p≈ôesnost: ${Math.round(userLocation.accuracy)} m)
                    `;
                },
                (error) => {
                    statusEl.className = 'geolocation-status error';
                    let message = 'Nepoda≈ôilo se z√≠skat polohu';

                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            message = 'P≈ô√≠stup k poloze byl zam√≠tnut. Povolte geolokaci v nastaven√≠ prohl√≠≈æeƒçe.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            message = 'Informace o poloze nejsou dostupn√©.';
                            break;
                        case error.TIMEOUT:
                            message = 'Vypr≈°el ƒças pro z√≠sk√°n√≠ polohy.';
                            break;
                    }

                    statusEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
                }
            );
        }

        // Select pricing plan
        function selectPlan(planId) {
            // Remove selected class from all cards
            document.querySelectorAll('.pricing-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selected class to clicked card
            const selectedCard = document.querySelector(`[data-plan="${planId}"]`);
            selectedCard.classList.add('selected');

            // Update hidden input
            document.getElementById('selectedPlan').value = planId;
        }

        // Form submission
        document.getElementById('providerRegistrationForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Odes√≠l√°m...';

            // Check if location is set
            if (!document.getElementById('latitude').value || !document.getElementById('longitude').value) {
                window.FIXO_API.showNotification('Pros√≠m, nejd≈ô√≠ve z√≠skejte svou polohu', 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-check-circle"></i> Registrovat se';
                return;
            }

            // Collect form data
            const formData = {
                companyName: document.getElementById('companyName').value,
                ico: document.getElementById('ico').value,
                contactName: document.getElementById('contactName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                serviceRadius: parseInt(document.getElementById('serviceRadius').value),
                specialization: Array.from(document.getElementById('specialization').selectedOptions).map(o => o.value),
                description: document.getElementById('description').value,
                location: {
                    latitude: parseFloat(document.getElementById('latitude').value),
                    longitude: parseFloat(document.getElementById('longitude').value)
                },
                plan: document.getElementById('selectedPlan').value
            };

            try {
                // Send registration request
                const response = await fetch(`${window.FIXO_API.config.BASE_URL}/api/providers/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    // If premium or enterprise plan, redirect to payment
                    if (formData.plan !== 'basic' && result.data.paymentUrl) {
                        window.FIXO_API.showNotification('Registrace √∫spƒõ≈°n√°! P≈ôesmƒõrov√°n√≠ na platbu...', 'success');
                        setTimeout(() => {
                            window.location.href = result.data.paymentUrl;
                        }, 2000);
                    } else {
                        window.FIXO_API.showNotification('Registrace √∫spƒõ≈°n√°! Brzy v√°s budeme kontaktovat.', 'success');
                        setTimeout(() => {
                            window.location.href = 'index.html';
                        }, 3000);
                    }
                } else {
                    throw new Error(result.error || 'Registrace selhala');
                }

            } catch (error) {
                console.error('Registration error:', error);
                window.FIXO_API.showNotification(`Chyba p≈ôi registraci: ${error.message}`, 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-check-circle"></i> Registrovat se';
            }
        });

        // Auto-select basic plan on load
        document.addEventListener('DOMContentLoaded', () => {
            selectPlan('basic');
            getLocation(); // Auto-get location on page load
        });
    </script>
</body>
</html>
